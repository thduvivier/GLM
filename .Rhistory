gam.check(profit.gam)
par(mfrow = c(1,1))
plot(profit.gam,residuals=FALSE,col="red",shade=TRUE, cex = 2)
pdf("./figures/T2_gam_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
pdf("./figures/T2_gam_resid_fblikes.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
dev.off()
pdf("./figures/T2_gam_resid_duration.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 3)
dev.off()
a = rnorm(100)
b = 1:100
c = sin(b) + a
plot(c)
d = gam(c ~ b)
summary(d)
plot(d)
d = gam(c ~ s(b, bs='ps'))
summary(d)
b = sin(1:100)
plot(b)
?sin
b = sin(1:100*pi)
plot(b)
c = b + a
d = gam(c ~ s(b, bs='ps'))
summary(d)
plot(d)
plot(d, shade = TRUE)
plot(c)
line(b)
lines(b)
plot(b)
x = 1:100
a = rnorm(100)
b = sin(x*pi/10)
c=a+b
plot(b)
plot(c)
model = gam(c~s(b, bs='ps'))
model = gam(c~s(b, bs='ps'))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
plot(b)
model = gam(c~s(b, bs='ps', k=20))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
b = sin(x*pi/13)
c=a+b
plot(b)
b = sin(x*(pi+0.2)/13)
c=a+b
plot(b)
b = sin(x*(pi+1)/13)
c=a+b
plot(b)
plot(c)
model = gam(c~s(b, bs='ps', k=20))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(c~s(b, bs='ps'))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(c~s(b, bs='ps', k=50))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
?s
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
a = rnorm(100)/10
b = sin(x*(pi+1)/13)
c=a+b
plot(b)
plot(c)
model = gam(c~s(b, bs='ps', k=50))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(c~s(b, bs='ps', k=20))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(c~s(b, bs='ps'))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps'))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=50))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=20))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps'))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=5))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=10))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=15))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=20))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=100))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=60))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
# Naive model
profit.gam <- gam(profit ~ s(budget,bs="ps", k=20) + s(director_facebook_likes, bs="ps", k=20) +
s(duration,bs="ps", k=20) + content_rating, data=df)
summary(profit.gam)
gam.check(profit.gam)
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 3)
# Naive model
profit.gam <- gam(profit ~ s(budget,bs="ps", k=20) + s(director_facebook_likes, bs="ps", k=15) +
s(duration,bs="ps", k=20) + content_rating, data=df)
summary(profit.gam)
gam.check(profit.gam)
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
# Naive model
profit.gam <- gam(profit ~ s(budget,bs="ps", k=20) + s(director_facebook_likes, bs="ps", k=20) +
s(duration,bs="ps", k=20) + content_rating, data=df)
summary(profit.gam)
gam.check(profit.gam)
par(mfrow = c(1,1))
plot(profit.gam,residuals=FALSE,col="red",shade=TRUE, cex = 2)
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
dev.off()
dev.off()
pdf("./figures/T2_gam_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
dev.off()
dev.off()
pdf("./figures/T2_gam_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
pdf("./figures/T2_gam_resid_fblikes.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
dev.off()
pdf("./figures/T2_gam_resid_duration.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 3)
dev.off()
# Naive model
profit.gam <- gam(profit ~ s(budget,bs="ps", k=10) + s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) + content_rating, data=df)
summary(profit.gam)
gam.check(profit.gam)
pdf("./figures/T2_gam_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
pdf("./figures/T2_gam_resid_fblikes.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
dev.off()
pdf("./figures/T2_gam_resid_duration.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(profit.gam,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 3)
dev.off()
# Step AIC procedure
profit.gam.full <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullA <- gam(profit ~ s(director_facebook_likes, bs="ps", k=10)+
s(duration,bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullB <- gam(profit ~ s(budget,bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullC <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullD <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df)
AIC(profit.gam.full, profit.gam.fullA, profit.gam.fullB,
profit.gam.fullC, profit.gam.fullD)
profit.gam.fullDA <- gam(profit ~ s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df)
profit.gam.fullDB <- gam(profit ~ s(budget,bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df)
profit.gam.fullDC <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10),
data=df)
AIC(profit.gam.full, profit.gam.fullD, profit.gam.fullDA, profit.gam.fullDB, profit.gam.fullDC)
profit.gam.fullDCA <- gam(profit ~ s(duration,bs="ps", k=10), data=df)
profit.gam.fullDCB <- gam(profit ~ s(director_facebook_likes, bs="ps", k=10), data=df)
AIC(profit.gam.full, profit.gam.fullD, profit.gam.fullDC, profit.gam.fullDCA, profit.gam.fullDCB)
summary(profit.gam.fullDC)
gam.check(profit.gam.fullDC)
plot(profit.gam.fullDC,residuals=TRUE,col="red",shade=TRUE, cex = 2)
pdf("./figures/T2_finalGAM_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow=c(1,1))
plot(profit.gam.fullDC,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
pdf("./figures/T2_finalGAM_resid_fblikes.pdf", width=7, height=4, pointsize=12)
par(mfrow=c(1,1))
plot(profit.gam.fullDC,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
dev.off()
summary(profit.gam.fullDC)
summary(profit.gam.fullDC)
gam.check(profit.gam.fullDC)
pdf("./figures/T2_finalGAM_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow=c(1,1))
plot(profit.gam.fullDC,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 1)
dev.off()
pdf("./figures/T2_finalGAM_resid_fblikes.pdf", width=7, height=4, pointsize=12)
par(mfrow=c(1,1))
plot(profit.gam.fullDC,residuals=TRUE,col="red",shade=TRUE, cex = 2, select = 2)
dev.off()
hat.gam.full = influence.gam(profit.gam.full)
summary(hat.gam.full)
plot(hat.gam.full, type='l')
which(hat.gam.full == max(hat.gam.full))
hat.gam.fullDC = influence.gam(profit.gam.fullDC)
summary(hat.gam.fullDC)
plot(hat.gam.fullDC, type='l')
which(hat.gam.fullDC == max(hat.gam.fullDC))
profit.gam.full.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df_outlier)
summary(profit.gam.full)
plot(profit.gam.full.outlier,residuals=TRUE,col="red",shade=TRUE, cex = 2)
profit.gam.full.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df_outlier)
summary(profit.gam.full)
# Remove the outlier:
df_outlier = df[-169, ]
profit.gam.full.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df_outlier)
summary(profit.gam.full)
plot(profit.gam.full.outlier,residuals=TRUE,col="red",shade=TRUE, cex = 2)
content_rating, data=df_outlier)
profit.gam.fullB.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df_outlier)
plot(profit.gam.full.outlier,residuals=TRUE,col="red",shade=TRUE, cex = 2)
profit.gam.fullA.outlier <- gam(profit ~ s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df_outlier)
profit.gam.fullB.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df_outlier)
profit.gam.fullC.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
content_rating, data=df_outlier)
profit.gam.fullD.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df_outlier)
AIC(profit.gam.full.outlier, profit.gam.fullA.outlier,
profit.gam.fullB.outlier, profit.gam.fullC.outlier,
profit.gam.fullD.outlier)
profit.gam.fullDA.outlier <- gam(profit ~ s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df)
profit.gam.fullDB.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df)
profit.gam.fullDC.outlier <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10),
data=df)
AIC(profit.gam.full.outlier, profit.gam.fullD.outlier,
profit.gam.fullDA.outlier, profit.gam.fullDB.outlier,
profit.gam.fullDC.outlier)
summary(profit.gam.fullD.outlier)
gam.check(profit.gam.fullD.outlier)
plot(profit.gam.fullD.outlier,residuals=TRUE,col="red",shade=TRUE, cex = 2)
hat.gam.fullD.outlier = influence.gam(profit.gam.fullD.outlier)
summary(hat.gam.fullD.outlier)
plot(hat.gam.fullD.outlier, type='l')
which(hat.gam.fullD.outlier == max(hat.gam.fullD.outlier))
profit.gam.full <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) + content_rating, data=df)
profit.gam.fullA <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
duration + content_rating, data=df)
profit.gam.fullB <- gam(profit ~ s(budget,bs="ps", k=10) +
director_facebook_likes +
s(duration,bs="ps", k=10) + content_rating, data=df)
profit.gam.fullC <- gam(profit ~ budget +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) + content_rating, data=df)
profit.gam.full.linear <- gam(profit ~ budget + director_facebook_likes +
duration + content_rating, data=df)
AIC(profit.gam.full, profit.gam.fullA, profit.gam.fullB,
profit.gam.fullC, profit.gam.full.linear)
profit.gam.full <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) + content_rating, data=df)
profit.gam.full.linearA <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
duration + content_rating, data=df)
profit.gam.full.linearB <- gam(profit ~ s(budget,bs="ps", k=10) +
director_facebook_likes +
s(duration,bs="ps", k=10) + content_rating, data=df)
profit.gam.full.linearC <- gam(profit ~ budget +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) + content_rating, data=df)
profit.gam.full.linear <- gam(profit ~ budget + director_facebook_likes +
duration + content_rating, data=df)
AIC(profit.gam.full, profit.gam.full.linearA, profit.gam.full.linearB,
profit.gam.full.linearC, profit.gam.full.linear)
profit.gam.fullA <- gam(profit ~ s(director_facebook_likes, bs="ps", k=10)+
s(duration,bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullB <- gam(profit ~ s(budget,bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullC <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
content_rating, data=df)
profit.gam.fullD <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10), data=df)
# Step AIC procedure
profit.gam.full <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10) +
s(duration,bs="ps", k=10) +
content_rating, data=df)
plot(hat.gam.fullDC, type='l')
plot(hat.gam.full, type='l')
pdf("./figures/T2_finalGAM_hatmatrix.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(hat.gam.fullDC, type='l')
dev.off()
summary(profit.gam.fullD.outlier)
pdf("./figures/T2_finalGAM_outlier_resid_budget.pdf", width=7, height=4, pointsize=12)
par(mfrow= c(1,1))
plot(profit.gam.fullD.outlier,residuals=TRUE,col="red",
shade=TRUE, cex = 2, select = 1)
dev.off()
pdf("./figures/T2_finalGAM_outlier_resid_fblikes.pdf", width=7, height=4, pointsize=12)
par(mfrow= c(1,1))
plot(profit.gam.fullD.outlier,residuals=TRUE,col="red",
shade=TRUE, cex = 2, select = 2)
dev.off()
pdf("./figures/T2_finalGAM_outlier_resid_duration.pdf", width=7, height=4, pointsize=12)
par(mfrow= c(1,1))
plot(profit.gam.fullD.outlier,residuals=TRUE,col="red",
shade=TRUE, cex = 2, select = 3)
dev.off()
pdf("./figures/T2_finalGAM_outlier_hatmatrix.pdf", width=7, height=4, pointsize=12)
par(mfrow = c(1,1))
plot(hat.gam.fullD.outlier, type='l')
dev.off()
lm.fit <- lm(profit ~ budget + director_facebook_likes, data =df)
summary(lm.fit)
AIC(lm.fit)
AIC(profit.gam.full, profit.gam.full.linearA, profit.gam.full.linearB,
profit.gam.full.linearC, profit.gam.full.linear)
summary(hat.gam.fullDC)
summary(profit.gam.fullDC)
profit.gam.fullDC <- gam(profit ~ s(budget,bs="ps", k=10) +
s(director_facebook_likes, bs="ps", k=10), data=df)
profit.gam.full.linearA <- gam(profit ~ budget +
s(director_facebook_likes, bs="ps", k=10),
data=df)
profit.gam.full.linearB <- gam(profit ~ s(budget,bs="ps", k=10) +
director_facebook_likes, data=df)
profit.gam.full.linear <- gam(profit ~ budget +
director_facebook_likes, data=df)
profit.lm.fit <- lm(profit ~ budget + director_facebook_likes, data =df)
AIC(profit.gam.fullDC, profit.gam.full.linearA, profit.gam.full.linearB,
profit.gam.full.linear, profit.lm.fit)
summary(profit.gam.full.linearB)
summary(profit.gam.full.linear)
AIC(profit.gam.fullDC, profit.gam.full.linearA, profit.gam.full.linearB,
profit.gam.full.linear, profit.lm.fit)
plot(df$budget, df$profit)
plot(df$director_facebook_likes, df$profit)
ggplot(df, aes(content_rating, profit)) +
geom_point()
abline(lm(profit~director_facebook_likes, data=df))
df.no.out <- df[-13,]
abline(lm(profit~director_facebook_likes, data=df.no.out), col="red")
plot(df$content_rating, df$profit)
df$director_facebook_likes2 <- df$director_facebook_likes^2
plot(df$director_facebook_likes2, df$profit)
df.gam <- gam(profit~s(df$budget, bs="ps", k=20)+s(df$director_facebook_likes,bs="ps", k=20)+
df$content_rating, data=df)
plot(df.gam, residuals=FALSE, cex=1.3, col="red", shade=TRUE)
plot(munich.gam,residuals=TRUE,cex=1.3,col="red",shade=TRUE)
ggplot(df, aes(budget, profit) ) +
geom_point() +
stat_smooth()
ggplot(df, aes(duration, profit) ) +
geom_point() +
stat_smooth()
ggplot(df, aes(director_facebook_likes, profit) ) +
geom_point() +
stat_smooth()
ggplot(df, aes(content_rating, y=profit) ) +
geom_point() +
stat_summary(fun.y=mean, geom="point", shape=20, size=4, color="red", fill="red")
# The model
# First we start with simple model, then increase by one variable at a time
# Two different tests are in use: LRT or score test (Rao)
logit.fit <- glm(I(profit>0) ~ budget, data = df, family = binomial)
summary(logit.fit)
add1(logit.fit,~ . + director_facebook_likes + content_rating + duration, test="LRT")
# Then we start with fully specified model
# Add or delete variables one by one
log.fit.1 <- glm(I(profit>0) ~ budget +
duration +
director_facebook_likes +
content_rating,
family = binomial,
data = df)
summary(log.fit.2)
# option Chisq is the same here as LRT
anova(log.fit.2,test="Chisq")
anova(carieslogitmodel2,test="LRT")
drop1(carieslogitmodel2,test="Chisq")
# Apply GAM
logitgam1 <- gam(I(profit > 0) ~
s(budget, bs="ps", k=30) +
duration +
director_facebook_likes +
content_rating,
data=df, family = binomial)
logitgam2 <- gam(I(profit > 0) ~
budget +
s(duration, bs="ps", k=30) +
director_facebook_likes +
content_rating,
data=df, family = binomial)
logitgam3 <- gam(I(profit > 0) ~
s(budget, bs="ps", k=30) +
s(duration, bs="ps", k=30) +
director_facebook_likes +
content_rating,
data=df, family = binomial)
logitgam4 <- gam(I(profit > 0) ~
s(budget, bs="ps", k=30),
data=df, family = binomial)
logitgam5 <- gam(I(profit > 0) ~
budget,
data=df, family = binomial)
logitgam6 <- gam(I(profit > 0) ~
s(duration, bs="ps", k=30),
data=df, family = binomial)
logitgam7 <- gam(I(profit > 0) ~
duration,
data=df, family = binomial)
logitgam8 <- gam(I(profit > 0) ~
s(budget, bs="ps", k=30) +
duration,
data=df, family = binomial)
AIC(log.fit.1, logitgam1, logitgam2, logitgam3, logitgam4, logitgam5, logitgam6,
logitgam7, logitgam8)
# Plot
plot(df$budget,df$profit.bin,pch="|",
cex.lab=1.5,cex.axis=1.3)
x <- seq(min(birthweight),max(birthweight))
lines(x,myexpit(x,b0=lrmod1$coeff[1],b1=lrmod1$coeff[2]),
lty=2,col="red",lwd=3)
lines(x,mycllit(x,b0=clmod1$coeff[1],b1=clmod1$coeff[2]),
lty=3,col="steelblue",lwd=3)
legend("topright",legend=c("Logistic","Comp Log Log"),lty=2:3,
bty="n",col=c("red","steelblue"),cex=1.5)
# Also check for model fit via residual deviance
attributes(summary(fit.logit))
dev <- summary(fit.logit)$deviance
df <- summary(fit.logit)$df.residual
1-pchisq(dev,df)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
model = gam(b~s(x, bs='ps', k=30))
summary(model)
gam.check(model)
plot(model,residuals=TRUE,col="red",shade=TRUE, cex = 2)
